<%- include('partials/header', { title: 'Satın Alma Durumu' }) %>
<h1>Satın Alma Durumu</h1>

<p><strong>Transaction ID:</strong> <code><%= txId %></code></p>
<p><strong>Durum:</strong> <%= purchase?.status %></p>

<% if (purchase?.offerId) { %>
  <p><strong>Offer:</strong> <code><%= purchase.offerId %></code> — <%= purchase.shortNotes %></p>
<% } %>

<% if (purchase?.status === 'DONE' && purchase?.confirmation) { %>
  <h3>Aktivasyon Bilgileri</h3>
  <ul>
    <li><strong>SM-DP+ Address:</strong> <%= purchase.confirmation.smdpAddress %></li>
    <li><strong>ICCID:</strong> <%= purchase.confirmation.iccid %></li>
    <li><strong>Activation Code:</strong> <%= purchase.confirmation.activationCode %></li>
    <li><strong>Reference:</strong> <%= purchase.confirmation.externalReferenceId %></li>
  </ul>
  <p>
    <a class="button" href="/purchases/<%= txId %>/qrcode">QR Kodu Göster</a>
    <% if (purchase.confirmation.redemptionInstructions) { %>
      · <a href="<%= purchase.confirmation.redemptionInstructions %>" target="_blank" rel="noreferrer">Kullanım Talimatları</a>
    <% } %>
  </p>
<% } else { %>
  <p>Sayfayı yenileyerek güncelleyebilirsiniz.</p>
  <form method="get" action="/purchases/<%= txId %>">
    <button type="submit">Yenile</button>
  </form>
<% } %>
<%- include('partials/footer') %>
